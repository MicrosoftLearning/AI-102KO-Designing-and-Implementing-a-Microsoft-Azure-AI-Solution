---
lab:
    title: '질문 답변 솔루션 만들기'
    module: '모듈 6 - QnA 솔루션 빌드'
---

# 질문 답변 솔루션 만들기

가장 흔히 진행되는 대화 시나리오 중 하나는 FAQ(질문과 대답) 기술 자료를 통한 지원 제공입니다. 대다수 조직은 FAQ를 문서나 웹 페이지로 게시합니다. 질문과 대답 쌍의 수가 적은 경우에는 이러한 방식에 문제가 없지만, 문서가 크면 검색이 어려우며 시간이 많이 걸릴 수 있습니다.

**Language** 서비스의 *질문 답변* 기능을 활용하면 자연어 입력을 사용하여 쿼리할 수 있는 질문과 대답 쌍이 포함된 기술 자료를 만들 수 있습니다. 기술 자료는 사용자가 제출한 질문의 대답을 조회하기 위해 봇이 사용할 수 있는 리소스로 가장 흔히 사용됩니다.

> **참고**: Language 서비스의 질문 답변 기능은 QnA Maker 서비스의 최신 버전에서 제공되는 기능입니다. QnA Maker 서비스는 별도의 서비스로 계속 제공됩니다.

## 이 과정용 리포지토리 복제

이 랩에서 작업을 수행 중인 환경에 **AI-102-AIEngineer** 코드 리포지토리를 아직 복제하지 않았다면 다음 단계에 따라 리포지토리를 지금 복제합니다. 리포지토리를 복제한 경우에는 Visual Studio Code에서 복제한 폴더를 엽니다.

1. Visual Studio Code를 시작합니다.
2. 팔레트를 열고(Shift+Ctrl+P 누르기) **Git: Clone** 명령을 실행하여 `https://github.com/MicrosoftLearning/AI-102KO-Designing-and-Implementing-a-Microsoft-Azure-AI-Solution` 리포지토리를 로컬 폴더(아무 폴더나 관계없음)에 복제합니다.
3. 리포지토리가 복제되면 Visual Studio Code에서 폴더를 엽니다.
4. 리포지토리의 C# 코드 프로젝트를 지원하는 추가 파일이 설치되는 동안 기다립니다.

    > **참고**: 빌드 및 디버그에 필요한 자산을 추가하라는 메시지가 표시되면 **나중에**를 선택합니다.

## Language 리소스 만들기

질문 답변용 기술 자료를 만들고 호스트하려면 Azure 구독의 **Language 서비스** 리소스가 필요합니다.

1. Azure Portal(`https://portal.azure.com`) 을 열고 Azure 구독과 연결된 Microsoft 계정을 사용하여 로그인합니다.
2. **&#65291;리소스 만들기** 단추를 선택하고 *Language*를 검색한 후에 **Language 서비스** 리소스를 만듭니다.
3. **사용자 지정 질문 답변** 블록에서 **선택**을 클릭합니다. 그런 다음에 **계속해서 리소스 만들기**를 클릭합니다. 다음 설정을 입력해야 합니다.
    
    - **구독**: *사용자의 Azure 구독*
    - **리소스 그룹**: *리소스 그룹 선택 또는 만들기(제한된 구독을 사용 중이라면 새 리소스 그룹을 만들 권한이 없을 수도 있으므로 제공된 리소스 그룹 사용)*
    - **지역**: *사용 가능한 아무 위치나 선택*
    - **이름**: *고유한 이름 입력*
    - **가격 책정 계층**: 표준 S
    - **Azure Search 위치**\*: *Language 리소스와 같은 글로벌 지역의 위치 선택*
    - **Azure Search 가격 책정 계층**: 무료(F)(*이 계층을 사용할 수 없으면 기본(B) 선택*)
    - **약관**: _동의_ 
    - **책임 있는 AI 알림**: _동의_
    
    \*맞춤형 질의응답은 Azure Search를 사용해 질문과 대답 기술 자료를 인덱싱 및 쿼리합니다.

4. 배포가 완료될 때까지 기다렸다가 배포 세부 정보를 확인합니다.

## 질문 답변 프로젝트 만들기

Language 리소스에서 질문 답변용 기술 자료를 만들려는 경우 Laugnage Studio 포털을 사용하여 질문 답변 프로젝트를 만들면 됩니다. 여기서는 [Microsoft Learn](https://docs.microsoft.com/learn) 관련 질문과 대답이 포함된 기술 자료를 만듭니다.

1. 새 브라우저 탭에서 *Language Studio* 포털 `https://language.azure.com` 으로 이동하여 Azure 구독과 연결된 Microsoft 계정을 사용하여 로그인합니다.
2. Language 리소스 선택 메시지가 표시되면 다음 설정을 선택합니다.
    - **Azure Directory**: 구독이 포함된 Azure 디렉터리
    - **Azure 구독**: Azure 구독.
    - **Language** 리소스: 앞에서 만든 Language 리소스
3. Language 리소스를 선택하라는 메시지가 표시되지 <u>않으면</u> 구독에 Language 리소스가 여러 개이기 때문일 수 있습니다. 이 경우에는 다음 단계를 수행합니다.
    1. 페이지 위쪽 표시줄에서 **설정(&#9881;)** 단추를 클릭합니다.
    2. **설정** 페이지에서 **리소스** 탭을 확인합니다.
    3. 앞에서 만든 Language 리소스를 선택하고 리소스 전환을 클릭합니다.
    4. 페이지 위쪽에서 Language Studio를 클릭하여 Language Studio 홈 페이지로 돌아옵니다.
3. 포털 위쪽의 **새로 만들기** 메뉴에서 **사용자 지정 질문 답변**을 선택합니다.
4. **프로젝트 만들기** 마법사의 **언어 설정 선택** 페이지에서 이 리소스의 모든 프로젝트용 언어를 설정하는 옵션을 선택하고 언어로 **영어**를 선택합니다. 그리고 **다음**을 클릭합니다.
5. **기본 정보 입력** 페이지에서 다음 세부 정보를 입력하고 **다음**을 클릭합니다.
    - **이름**: LearnFAQ
    - **설명**: Microsoft Learn용 FAQ
    - **답변 미반환 시의 기본 답변**: 죄송합니다. 질문을 이해할 수 없습니다.
6. **검토 후 완료** 페이지에서 **프로젝트 만들기**를 클릭합니다.

## 기술 자료에 원본 추가

기술 자료를 처음부터 만들어도 되지만 일반적으로는 기존 FAQ 페이지나 문서에서 질문과 대답을 가져오는 작업부터 시작합니다. 여기서는 Microsoft Learn용 기존 FAQ 웹 페이지에서 데이터를 가져옵니다. 그리고 흔히 진행되는 대화를 지원하기 위해 미리 정의된 몇 가지 "잡담" 질문과 답변도 가져옵니다.

1. 질문 답변 프로젝트의 **원본 관리** 페이지 내 **&#9547; 원본 추가** 목록에서 **URL**을 선택합니다. 그런 다음 **URL 추가** 대화 상자에서 **&#9547; URL 추가**를 클릭하고 다음 URL을 추가한 후에 **모두 추가**를 클릭하여 기술 자료에 해당 URL을 추가합니다.
    - **이름**: `Learn FAQ Page`
    - **URL**: `https://docs.microsoft.com/en-us/learn/support/faq`
2. 질문 답변 프로젝트의 **원본 관리** 페이지 내 **&#9547; 원본 추가** 목록에서 **잡담**을 선택합니다. 그런 다음 **잡담 추가** 대화 상자에서 **약식**을 선택하고 **잡담 추가**를 클릭합니다.

## 기술 자료 편집

앞에서 만든 기술 자료에는 Microsoft Learn FAQ의 질문과 대답 쌍이 입력되었으며 대화형 *잡담* 질문과 대답 쌍 세트가 추가되었습니다. 질문과 대답 쌍을 더 추가하여 기술 자료를 확장할 수 있습니다.

1. Language Studio의 **LearnFAQ** 프로젝트에서 **기술 자료 편집** 페이지를 선택하여 기존 질문과 답변 쌍을 확인합니다(팁이 표시되면 해당 내용을 확인한 후 **확인**을 클릭하여 팁 표시를 해제하거나 **모두 건너뛰기** 클릭).
2. 기술 자료에서 **&#65291; 질문 쌍 추가**를 선택합니다.
3. **질문** 상자에 `What is Microsoft certification?`을 입력하고 **Enter** 키를 누릅니다.
4. **&#65291; 대체 구 추가**를 선택하고 `How can I demonstrate my Microsoft technology skills?`를 입력한 후에 **Enter** 키를 누릅니다.
5. **대답** 상자에 `The Microsoft Certified Professional program enables you to validate and prove your skills with Microsoft technologies.`를 입력하고 **Enter** 키를 누른 후에 **제출**을 클릭하여 질문(대체 구 포함)과 대답을 기술 자료에 추가합니다.

    사용자가 대답을 확인한 후 추가 작업으로 *멀티 턴* 대화를 작성하면 효율적인 경우도 있습니다. 그러면 사용자가 질문을 여러 번 구체화하여 필요한 대답을 확인할 수 있습니다.

6. 인증 관련 질문에 입력한 대답 아래에서 **&#65291; 후속 프롬프트 추가**를 선택합니다.
7. **후속 프롬프트** 대화 상자에서 다음 설정을 입력하고 **프롬프트 추가**를 클릭합니다.
    - **프롬프트에서 사용자에게 표시되는 텍스트**: `Learn more about certification.`
    - **새 쌍의 링크 만들기**를 선택하고 다음 텍스트를 입력합니다. `You can learn more about certification on the [Microsoft certification page](https://docs.microsoft.com/learn/certifications/).`
    - **상황별 흐름에만 표시**: 선택 *이 옵션을 선택하면 원래 인증 관련 질문의 후속 질문 컨텍스트에서만 대답이 반환됩니다.*

## 기술 자료 학습 및 테스트

이제 기술 자료를 만들었으므로 QnA Maker 포털에서 테스트할 수 있습니다.

1. 페이지 오른쪽 위의 **변경 내용 저장**을 클릭합니다.
2. 변경 내용을 저장한 후 **테스트**를 클릭하여 테스트 창을 엽니다.
3. 테스트 창 위쪽에서 짧은 대답 표시 옵션을 *선택 취소*합니다. 그런 다음 아래쪽에 `Hello`라는 메시지를 입력합니다. 적절한 응답이 반환되어야 합니다.
4. 테스트 창 아래쪽에 `What is Microsoft Learn?`이라는 메시지를 입력합니다. FAQ에서 적절한 응답이 반환되어야 합니다.
5. `Thanks!`라는 메시지를 입력합니다. 적절한 잡담 응답이 반환되어야 합니다.
6. `Tell me about certification`이라는 메시지를 입력합니다. 앞에서 작성한 대답이 반환되고 후속 프롬프트 링크가 표시되어야 합니다.
7. **Learn more about certification** 후속 프롬프트 링크를 선택합니다. 인증 페이지 링크가 포함된 후속 질문의 대답이 반환되어야 합니다.
8. 기술 자료 테스트가 완료되면 테스트 창을 닫습니다.

## 기술 자료 배포 및 테스트

기술 자료는 클라이언트 애플리케이션이 질문의 대답을 찾는 데 사용할 수 있는 백 엔드 서비스를 제공합니다. 이제 기술 자료를 게시하고 클라이언트에서 기술 자료 REST 인터페이스에 액세스할 수 있습니다.

1. Language Studio의 **LearnFAQ** 프로젝트에서 **기술 자료 배포** 페이지를 선택합니다.
2. 페이지 위쪽에서 **배포**를 클릭합니다. 그런 다음 **배포**를 클릭하여 기술 자료를 배포할 것임을 확인합니다.
3. 배포가 완료되면 **예측 URL 가져오기**를 클릭하여 기술 자료의 REST 엔드포인트를 확인한 후 클립보드에 복사합니다(아직 대화 상자를 닫지는 마세요).
4. Visual Studio Code의 **12-qna** 폴더에서 **ask-question.cmd**를 엽니다. 이 스크립트는 **Curl**을 사용하여 질문 답변 엔드포인트의 REST 인터페이스를 호출합니다.
5. 스크립트에서 *YOUR_PREDICTION_ENDPOINT*를 앞에서 복사한 예측 엔드포인트로 바꿉니다(엔드포인트를 따옴표로 묶어서 입력해야 함).
6. 브라우저로 돌아와 **예측 URL 가져오기** 대화 상자에서 샘플 요청에 **Ocp-Apim-Subscription-Key** 매개 변수의 값이 포함되어 있음을 확인합니다. 이 값은 *ab12c345de678fg9hijk01lmno2pqrs34*와 같은 형식입니다. 이 값은 리소스용 권한 부여 키입니다. 해당 값을 클립보드에 복사한 후 **확인**을 클릭하여 대화 상자를 닫습니다.
7. Visual Studio Code로 돌아와 **ask-question.cmd** 스크립트에서 *YOUR_KEY*를 앞에서 복사한 키로 바꿉니다(키를 따옴표로 묶어서 입력해야 함).
8. 스크립트의 Curl 명령은 값이 **What is a Learning Path?** 인 **question** 매개 변수를 제출합니다.
9. 전체 스크립트가 다음 코드와 같이 표시되는지 확인하고 파일을 저장합니다.

    ```
    @echo off
    SETLOCAL ENABLEDELAYEDEXPANSION

    rem Set variables
    set prediction_url="https://some-name.cognitiveservices.azure.com/language/......."
    set key="ab12c345de678fg9hijk01lmno2pqrs34"

    curl -X POST !prediction_url! -H "Ocp-Apim-Subscription-Key: !key!" -H "Content-Type: application/json" -d "{'question': 'What is a learning Path?' }"
    ```

10. Visual Studio Code의 탐색기 창에서 **ask-question.cmd** 스크립트를 마우스 오른쪽 단추로 클릭하고 **통합 터미널에서 열기**를 선택합니다.
11. 터미널 창에 `ask-question.cmd` 명령을 입력하여 스크립트를 실행하고 서비스가 반환하는 JSON 응답을 확인합니다. 이 응답에는 *What is a learning path?* 라는 질문에 적합한 대답이 포함되어 있어야 합니다.

## 기술 자료용 봇 만들기

기술 자료에서 대답을 검색하는 데 사용되는 클라이언트 애플리케이션으로는 봇이 가장 흔히 사용됩니다.

1. 브라우저의 Language Studio로 돌아와 **기술 자료 배포** 페이지에서 **봇 만들기**를 선택합니다. 그러면 새 브라우저 탭에서 Azure Portal이 열리므로 Azure 구독에서 웹앱 봇을 만들 수 있습니다(로그인하라는 메시지가 표시되면 로그인합니다).
2. Azure Portal에서 다음 설정을 사용하여 웹앱 봇을 만듭니다(대다수 설정은 자동 입력됨).

    *누락된 값이 있으면 브라우저를 새로 고치세요.*  

  - **봇 핸들**: *봇의 고유한 이름*
  - **구독**: *사용자의 Azure 구독*
  - **리소스 그룹**: *Language 리소스가 포함된 리소스 그룹*
  - **위치**: *Text Analytics 서비스와 같은 위치*
  - **가격 책정 계층**: F0
  - **앱 이름**: ***봇 핸들**과 같은 이름. 고유 ID와 *[.azurewebsites.net]* 이 자동 추가됨*
  - **SDK 언어**: *C# 또는 Node.js 선택*
  - **QnA 인증 키**: *QnA 기술 자료용 인증 키로 자동 설정됨*
  - **App Service 계획/위치**: *적절한 계획과 위치가 있는 경우 자동 설정될 수 있음. 계획이 없는 경우 새로 만들어야 함*
  - **Application Insights**: 꺼짐
  - **Microsoft 앱 ID 및 암호**: 앱 ID 및 암호 자동 생성
3. 봇이 생성될 때까지 기다립니다. 그런 다음 **리소스로 이동**을 클릭합니다(홈 페이지에서 **리소스 그룹**을 클릭하고 웹앱 봇을 만든 리소스 그룹을 연 다음 봇을 클릭해도 됨).
4. 봇 블레이드에서 **웹 채팅에서 테스트** 페이지를 표시하고 봇이 **Hello and welcome!** 이라는 메시지를 표시할 때까지 기다립니다. (초기화하는 데 몇 초 걸릴 수도 있습니다.)
5. 테스트 채팅 인터페이스를 사용하여 봇이 기술 자료의 질문에 적절하게 대답을 하는지 확인합니다. 예를 들어 `What is Microsoft certification?` 등의 질문을 제출해 봅니다.

## 자세한 정보

Language 서비스의 질문 답변 기능에 대해 자세히 알아보려면 [Language 서비스 설명서](https://docs.microsoft.com/ko-kr/azure/cognitive-services/language-service/question-answering/overview) 를 참조하세요.
